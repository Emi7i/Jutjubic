<div class="container">
  <h2>Upload Video</h2>

  <form [formGroup]="uploadForm" (ngSubmit)="onSubmit()">

    <div>
      <label for="title">Title *</label>
      <input type="text" id="title" formControlName="title">
      <small *ngIf="uploadForm.get('title')?.invalid && uploadForm.get('title')?.touched">
        Title is required (3-100 characters)
      </small>
    </div>

    <div>
      <label for="description">Description *</label>
      <textarea id="description" formControlName="description" rows="4"></textarea>
      <small *ngIf="uploadForm.get('description')?.invalid && uploadForm.get('description')?.touched">
        Description is required (10-1000 characters)
      </small>
    </div>

    <div>
      <label>Tags *</label>
      <input type="text" [(ngModel)]="tagInput" [ngModelOptions]="{standalone: true}"
             (keyup.enter)="addTag()" placeholder="Press Enter to add">
      <div *ngIf="tags.length > 0">
        <span *ngFor="let tag of tags" style="margin: 5px; display: inline-block;">
          {{ tag }} <button type="button" (click)="removeTag(tag)">Ã—</button>
        </span>
      </div>
    </div>

    <div>
      <label for="thumbnail">Thumbnail *</label>
      <input type="file" id="thumbnail" accept="image/*" (change)="onThumbnailSelected($event)">
      <img *ngIf="thumbnailPreview" [src]="thumbnailPreview" style="max-width: 200px; margin-top: 10px;">
    </div>

    <div>
      <label for="video">Video (MP4, max 200MB) *</label>
      <input type="file" id="video" accept="video/mp4" (change)="onVideoSelected($event)">
      <video *ngIf="videoPreview" [src]="videoPreview" controls style="max-width: 400px; margin-top: 10px;"></video>
    </div>

    <div>
      <label>
        <input type="checkbox" [(ngModel)]="useLocation" [ngModelOptions]="{standalone: true}" (change)="toggleLocation()">
        Add location (optional)
      </label>
      <div *ngIf="currentLocation">
        Location: {{ currentLocation.address || (currentLocation.latitude + ', ' + currentLocation.longitude) }}
      </div>
    </div>

    <div *ngIf="errorMessage" style="color: red;">{{ errorMessage }}</div>

    <div *ngIf="uploadProgress">
      <p>{{ uploadProgress.message }} - {{ uploadProgress.percentage }}%</p>
      <progress [value]="uploadProgress.percentage" max="100"></progress>
    </div>

    <button type="submit" [disabled]="isUploading || uploadForm.invalid">
      {{ isUploading ? 'Uploading...' : 'Upload Video' }}
    </button>
    <button type="button" (click)="resetForm()" [disabled]="isUploading">Reset</button>
  </form>
</div>
